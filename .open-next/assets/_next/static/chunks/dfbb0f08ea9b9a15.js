(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,4304,e=>{"use strict";var t=e.i(1398),s=e.i(1788),a=e.i(1158),r=e.i(9632),l=e.i(9338);function d(){let[e,d]=(0,s.useState)([]),[i,n]=(0,s.useState)([]),[c,x]=(0,s.useState)(!0),[o,u]=(0,s.useState)(null),[h,m]=(0,s.useState)(""),[p,v]=(0,s.useState)(""),[j,b]=(0,s.useState)("");(0,s.useEffect)(()=>{!async function(){try{let e=(await l.apiClient.getMyClasses()).data||[];if(n(e),0===e.length)return void x(!1);let t=[];for(let s of e)for(let e of(await l.apiClient.getSessionHistory(s.id).catch(()=>({data:[]}))).data||[]){let a=await l.apiClient.getSessionStudents(e.session_id).catch(()=>({data:{students:[]}})),r=a.data?.students||a.data||[];Array.isArray(r)&&r.forEach(a=>{t.push({id:`${e.session_id}-${a.student_id||a.id}`,student_id:a.student_id||a.id||0,student_name:a.name,nim:a.nim,class_id:s.id,class_name:s.name,class_code:s.class_code,session_id:e.session_id,week:e.week,status:a.status,recorded_at:a.recorded_at})})}t.sort((e,t)=>{let s=e.recorded_at?new Date(e.recorded_at).getTime():0;return(t.recorded_at?new Date(t.recorded_at).getTime():0)-s}),d(t)}catch(e){console.error("Failed to fetch attendance data:",e),u(e instanceof Error?e.message:"Failed to load attendance data")}finally{x(!1)}}()},[]);let w=e.filter(e=>{if(h&&e.class_code!==h||p&&e.status!==p)return!1;if(j){let t=j.toLowerCase();if(!e.student_name.toLowerCase().includes(t)&&!e.nim.toLowerCase().includes(t))return!1}return!0}),f={present:w.filter(e=>"p"===e.status).length,absent:w.filter(e=>"a"===e.status).length,sick:w.filter(e=>"s"===e.status).length,permission:w.filter(e=>"i"===e.status).length,notRecorded:w.filter(e=>null===e.status).length};return c?(0,t.jsx)(r.default,{title:"Attendance",subtitle:"Loading...",children:(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 text-[var(--rawuh-text-muted)]",children:[(0,t.jsx)("span",{className:"material-symbols-outlined animate-spin",children:"progress_activity"}),(0,t.jsx)("span",{children:"Loading attendance data..."})]})})}):o?(0,t.jsx)(r.default,{title:"Attendance",subtitle:"Error",children:(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("span",{className:"material-symbols-outlined text-4xl text-[var(--rawuh-error)] mb-2",children:"error"}),(0,t.jsx)("p",{className:"text-[var(--rawuh-error)]",children:o}),(0,t.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-[var(--rawuh-primary)] text-white rounded-lg text-sm",children:"Retry"})]})})}):(0,t.jsxs)(r.default,{title:"Attendance",subtitle:"View and manage attendance records",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[(0,t.jsx)("div",{className:"bg-white rounded-xl border border-[var(--rawuh-border)] p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-[var(--rawuh-success-muted)] flex items-center justify-center",children:(0,t.jsx)("span",{className:"material-symbols-outlined text-xl text-[var(--rawuh-success)]",children:"check_circle"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-[var(--rawuh-text)]",children:f.present}),(0,t.jsx)("p",{className:"text-sm text-[var(--rawuh-text-muted)]",children:"Present"})]})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl border border-[var(--rawuh-border)] p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-[var(--rawuh-error-muted)] flex items-center justify-center",children:(0,t.jsx)("span",{className:"material-symbols-outlined text-xl text-[var(--rawuh-error)]",children:"cancel"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-[var(--rawuh-text)]",children:f.absent}),(0,t.jsx)("p",{className:"text-sm text-[var(--rawuh-text-muted)]",children:"Absent"})]})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl border border-[var(--rawuh-border)] p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-[var(--rawuh-warning-muted)] flex items-center justify-center",children:(0,t.jsx)("span",{className:"material-symbols-outlined text-xl text-[var(--rawuh-warning)]",children:"sick"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-[var(--rawuh-text)]",children:f.sick}),(0,t.jsx)("p",{className:"text-sm text-[var(--rawuh-text-muted)]",children:"Sick"})]})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl border border-[var(--rawuh-border)] p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-[var(--rawuh-primary-muted)] flex items-center justify-center",children:(0,t.jsx)("span",{className:"material-symbols-outlined text-xl text-[var(--rawuh-primary)]",children:"event_busy"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-[var(--rawuh-text)]",children:f.permission}),(0,t.jsx)("p",{className:"text-sm text-[var(--rawuh-text-muted)]",children:"Permission"})]})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl border border-[var(--rawuh-border)] p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-gray-100 flex items-center justify-center",children:(0,t.jsx)("span",{className:"material-symbols-outlined text-xl text-gray-500",children:"help"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-[var(--rawuh-text)]",children:f.notRecorded}),(0,t.jsx)("p",{className:"text-sm text-[var(--rawuh-text-muted)]",children:"Not Recorded"})]})]})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,t.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,t.jsx)("span",{className:"material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-[var(--rawuh-text-muted)] text-xl",children:"search"}),(0,t.jsx)("input",{type:"text",placeholder:"Search by student name or NIM...",value:j,onChange:e=>b(e.target.value),className:"w-full h-10 pl-10 pr-4 bg-white rounded-lg text-sm text-[var(--rawuh-text)] placeholder:text-[var(--rawuh-text-muted)] border border-[var(--rawuh-border)] focus:border-[var(--rawuh-primary)] focus:outline-none"})]}),(0,t.jsxs)("select",{value:h,onChange:e=>m(e.target.value),className:"h-10 px-4 bg-white rounded-lg text-sm text-[var(--rawuh-text)] border border-[var(--rawuh-border)]",children:[(0,t.jsx)("option",{value:"",children:"All Classes"}),i.map(e=>(0,t.jsxs)("option",{value:e.class_code,children:[e.class_code," - ",e.name]},e.id))]}),(0,t.jsxs)("select",{value:p,onChange:e=>v(e.target.value),className:"h-10 px-4 bg-white rounded-lg text-sm text-[var(--rawuh-text)] border border-[var(--rawuh-border)]",children:[(0,t.jsx)("option",{value:"",children:"All Status"}),(0,t.jsx)("option",{value:"p",children:"Present"}),(0,t.jsx)("option",{value:"a",children:"Absent"}),(0,t.jsx)("option",{value:"s",children:"Sick"}),(0,t.jsx)("option",{value:"i",children:"Permission"})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-[var(--rawuh-border)] overflow-hidden",children:[0===w.length?(0,t.jsxs)("div",{className:"p-12 text-center",children:[(0,t.jsx)("span",{className:"material-symbols-outlined text-4xl text-[var(--rawuh-text-muted)] mb-2",children:"fact_check"}),(0,t.jsx)("p",{className:"text-[var(--rawuh-text-muted)]",children:"No attendance records found"})]}):(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-[var(--rawuh-background)]",children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-[var(--rawuh-text-muted)] uppercase",children:"Student"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-[var(--rawuh-text-muted)] uppercase",children:"Class"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-[var(--rawuh-text-muted)] uppercase",children:"Week"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-[var(--rawuh-text-muted)] uppercase",children:"Status"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-[var(--rawuh-text-muted)] uppercase",children:"Date & Time"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-[var(--rawuh-text-muted)] uppercase",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-[var(--rawuh-border)]",children:w.slice(0,50).map(e=>{var s,r;let d=e.status?l.attendanceStatusColors[e.status]:{bg:"#f3f4f6",text:"#6b7280"},i=e.status?l.attendanceStatusLabels[e.status]:"Not Recorded";return(0,t.jsxs)("tr",{className:"hover:bg-[var(--rawuh-background)]",children:[(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-9 h-9 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center text-white text-sm font-medium",children:e.student_name.charAt(0)}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-[var(--rawuh-text)]",children:e.student_name}),(0,t.jsx)("p",{className:"text-sm text-[var(--rawuh-text-muted)]",children:e.nim})]})]})}),(0,t.jsxs)("td",{className:"px-6 py-4",children:[(0,t.jsx)("p",{className:"text-sm text-[var(--rawuh-text)]",children:e.class_name}),(0,t.jsx)("p",{className:"text-xs text-[var(--rawuh-text-muted)]",children:e.class_code})]}),(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsx)("span",{className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-gray-100 text-sm font-medium",children:e.week})}),(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsx)("span",{className:"inline-flex px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:d.bg,color:d.text},children:i})}),(0,t.jsxs)("td",{className:"px-6 py-4",children:[(0,t.jsx)("p",{className:"text-sm text-[var(--rawuh-text)]",children:(s=e.recorded_at)?new Date(s).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"}):"-"}),(0,t.jsx)("p",{className:"text-xs text-[var(--rawuh-text-muted)]",children:(r=e.recorded_at)?new Date(r).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"-"})]}),(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsx)(a.default,{href:`/classes/${e.class_id}`,className:"p-2 rounded-lg hover:bg-gray-100 text-[var(--rawuh-text-muted)] inline-flex",children:(0,t.jsx)("span",{className:"material-symbols-outlined text-xl",children:"visibility"})})})]},e.id)})})]}),w.length>50&&(0,t.jsxs)("div",{className:"px-6 py-4 border-t border-[var(--rawuh-border)] text-center text-sm text-[var(--rawuh-text-muted)]",children:["Showing 50 of ",w.length," records"]})]})]})}e.s(["default",()=>d])},1585,(e,t,s)=>{let a="/attendance";(window.__NEXT_P=window.__NEXT_P||[]).push([a,()=>e.r(4304)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([a])})},8761,e=>{e.v(t=>Promise.all(["static/chunks/df56c2ef92c6043e.js"].map(t=>e.l(t))).then(()=>t(3594)))},8805,e=>{e.v(t=>Promise.all(["static/chunks/5ec9ab7aae3f3e76.js"].map(t=>e.l(t))).then(()=>t(9466)))}]);