(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7856,e=>{"use strict";var t=e.i(1398),s=e.i(1788),a=e.i(9632);function r({icon:e,iconBgColor:s,title:a,value:r,trend:l,subtitle:i}){return(0,t.jsxs)("div",{className:"bg-white rounded-xl p-5 border border-[var(--rawuh-border)]",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center",style:{backgroundColor:s},children:e}),l&&(0,t.jsxs)("div",{className:`flex items-center gap-1 text-sm font-medium ${l.isPositive?"text-[var(--rawuh-success)]":"text-[var(--rawuh-error)]"}`,children:[(0,t.jsx)("span",{className:"material-symbols-outlined text-lg",children:l.isPositive?"trending_up":"trending_down"}),l.value,"%"]})]}),(0,t.jsx)("p",{className:"text-sm text-[var(--rawuh-text-muted)] mb-1",children:a}),(0,t.jsx)("p",{className:"text-2xl font-bold text-[var(--rawuh-text)]",children:r}),i&&(0,t.jsx)("p",{className:"text-xs text-[var(--rawuh-text-muted)] mt-1",children:i})]})}var l=e.i(1158),i=e.i(9338);function n(){let[e,a]=(0,s.useState)([]),[r,n]=(0,s.useState)(!0),[d,c]=(0,s.useState)(null);return((0,s.useEffect)(()=>{!async function(){try{let e=await i.apiClient.getMyClasses();a(e.data)}catch(e){console.error("Failed to fetch classes:",e),c(e instanceof Error?e.message:"Failed to load classes")}finally{n(!1)}}()},[]),r)?(0,t.jsx)("div",{className:"bg-white rounded-xl border border-[var(--rawuh-border)] p-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-center gap-3 text-[var(--rawuh-text-muted)]",children:[(0,t.jsx)("span",{className:"material-symbols-outlined animate-spin",children:"progress_activity"}),(0,t.jsx)("span",{children:"Loading classes..."})]})}):d?(0,t.jsx)("div",{className:"bg-white rounded-xl border border-[var(--rawuh-border)] p-8",children:(0,t.jsxs)("div",{className:"text-center text-[var(--rawuh-error)]",children:[(0,t.jsx)("span",{className:"material-symbols-outlined text-2xl mb-2",children:"error"}),(0,t.jsx)("p",{children:d})]})}):0===e.length?(0,t.jsx)("div",{className:"bg-white rounded-xl border border-[var(--rawuh-border)] p-8",children:(0,t.jsxs)("div",{className:"text-center text-[var(--rawuh-text-muted)]",children:[(0,t.jsx)("span",{className:"material-symbols-outlined text-4xl mb-2",children:"school"}),(0,t.jsx)("p",{children:"No classes found"})]})}):(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-[var(--rawuh-border)] overflow-hidden",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-[var(--rawuh-border)] flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-[var(--rawuh-text)]",children:"My Classes"}),(0,t.jsx)("p",{className:"text-sm text-[var(--rawuh-text-muted)]",children:"Classes you are teaching this semester"})]}),(0,t.jsx)(l.default,{href:"/classes",className:"text-sm font-medium text-[var(--rawuh-primary)] hover:underline",children:"View All"})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-[var(--rawuh-background)]",children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-[var(--rawuh-text-muted)] uppercase tracking-wider",children:"Class"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-[var(--rawuh-text-muted)] uppercase tracking-wider",children:"Code"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-[var(--rawuh-text-muted)] uppercase tracking-wider",children:"Section"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-[var(--rawuh-text-muted)] uppercase tracking-wider",children:"Schedule"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-[var(--rawuh-text-muted)] uppercase tracking-wider",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-[var(--rawuh-border)]",children:e.slice(0,5).map(e=>(0,t.jsxs)("tr",{className:"hover:bg-[var(--rawuh-background)] transition-colors",children:[(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-[var(--rawuh-primary-muted)] flex items-center justify-center",children:(0,t.jsx)("span",{className:"material-symbols-outlined text-xl text-[var(--rawuh-primary)]",style:{fontVariationSettings:"'FILL' 0, 'wght' 400"},children:"school"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-[var(--rawuh-text)]",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-[var(--rawuh-text-muted)]",children:e.lecturer})]})]})}),(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsx)("span",{className:"inline-flex px-2.5 py-1 rounded-md bg-gray-100 text-sm font-medium text-[var(--rawuh-text)]",children:e.class_code})}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm text-[var(--rawuh-text)]",children:e.class_section}),(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsx)("p",{className:"font-medium text-[var(--rawuh-text)]",children:e.day}),(0,t.jsxs)("p",{className:"text-[var(--rawuh-text-muted)]",children:[e.start_time," - ",e.end_time]})]})}),(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.default,{href:`/classes/${e.id}?startSession=true`,className:"p-2 rounded-lg hover:bg-[var(--rawuh-primary-muted)] flex items-center justify-center text-[var(--rawuh-primary)] transition-colors",children:(0,t.jsx)("span",{className:"material-symbols-outlined text-xl",style:{fontVariationSettings:"'FILL' 0, 'wght' 400"},children:"play_circle"})}),(0,t.jsx)(l.default,{href:`/classes/${e.id}`,className:"p-2 rounded-lg hover:bg-gray-100 flex items-center justify-center text-[var(--rawuh-text-muted)] transition-colors",children:(0,t.jsx)("span",{className:"material-symbols-outlined text-xl",style:{fontVariationSettings:"'FILL' 0, 'wght' 400"},children:"visibility"})})]})})]},e.id))})]})}),e.length>5&&(0,t.jsx)("div",{className:"px-6 py-4 border-t border-[var(--rawuh-border)] text-center",children:(0,t.jsxs)(l.default,{href:"/classes",className:"text-sm font-medium text-[var(--rawuh-primary)] hover:underline",children:["View all ",e.length," classes â†’"]})})]})}function d(){let[e,a]=(0,s.useState)([]),[r,l]=(0,s.useState)(!0),[n,d]=(0,s.useState)({present:0,absent:0,rate:0});if((0,s.useEffect)(()=>{!async function(){try{let e=(await i.apiClient.getMyClasses()).data||[];if(0===e.length)return void l(!1);let t=e.map(e=>i.apiClient.getSessionHistory(e.id).catch(()=>({data:[]}))),s=await Promise.all(t),r=new Map;s.forEach(e=>{(e.data||[]).forEach(e=>{if(e.week&&e.total_students){let t=r.get(e.week)||{present:0,total:0};t.present+=e.present_count||0,t.total+=e.total_students,r.set(e.week,t)}})});let n=Array.from(r.entries()).sort((e,t)=>e[0]-t[0]).slice(-6).map(([e,t])=>({week:`W${e}`,present:t.present,absent:t.total-t.present}));a(n);let c=n.reduce((e,t)=>e+t.present,0),x=n.reduce((e,t)=>e+t.absent,0),o=c+x,u=o>0?Math.round(c/o*100):0;d({present:c,absent:x,rate:u})}catch(e){console.error("Failed to fetch attendance data:",e)}finally{l(!1)}}()},[]),r)return(0,t.jsx)("div",{className:"bg-white rounded-xl border border-[var(--rawuh-border)] p-5",children:(0,t.jsxs)("div",{className:"flex items-center justify-center gap-3 text-[var(--rawuh-text-muted)] py-12",children:[(0,t.jsx)("span",{className:"material-symbols-outlined animate-spin",children:"progress_activity"}),(0,t.jsx)("span",{children:"Loading chart..."})]})});if(0===e.length)return(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-[var(--rawuh-border)] p-5",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-[var(--rawuh-text)]",children:"Attendance Trend"}),(0,t.jsx)("p",{className:"text-sm text-[var(--rawuh-text-muted)]",children:"Weekly attendance overview"})]})}),(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("span",{className:"material-symbols-outlined text-4xl text-[var(--rawuh-text-muted)] mb-2",children:"bar_chart"}),(0,t.jsx)("p",{className:"text-sm text-[var(--rawuh-text-muted)]",children:"No attendance data yet"})]})]});let c=Math.max(...e.map(e=>e.present+e.absent));return(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-[var(--rawuh-border)] p-5",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-[var(--rawuh-text)]",children:"Attendance Trend"}),(0,t.jsx)("p",{className:"text-sm text-[var(--rawuh-text-muted)]",children:"Weekly attendance overview"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-[var(--rawuh-success)]"}),(0,t.jsx)("span",{className:"text-xs text-[var(--rawuh-text-muted)]",children:"Present"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-[var(--rawuh-error)]"}),(0,t.jsx)("span",{className:"text-xs text-[var(--rawuh-text-muted)]",children:"Absent"})]})]})]}),(0,t.jsxs)("div",{className:"relative h-[180px]",children:[(0,t.jsxs)("div",{className:"absolute left-0 top-0 h-[160px] flex flex-col justify-between text-xs text-[var(--rawuh-text-muted)] pr-2",children:[(0,t.jsx)("span",{children:c}),(0,t.jsx)("span",{children:Math.round(.5*c)}),(0,t.jsx)("span",{children:"0"})]}),(0,t.jsx)("div",{className:"absolute left-6 right-0 top-0 h-[160px] flex flex-col justify-between",children:[0,1,2].map(e=>(0,t.jsx)("div",{className:"w-full border-t border-dashed border-[var(--rawuh-border)]"},e))}),(0,t.jsx)("div",{className:"absolute left-8 right-0 bottom-5 top-0 flex items-end justify-around gap-2",children:e.map(e=>{let s=c>0?e.present/c*160:0,a=c>0?e.absent/c*160:0;return(0,t.jsx)("div",{className:"flex flex-col items-center gap-1 flex-1",children:(0,t.jsxs)("div",{className:"flex flex-col items-center w-full max-w-[40px]",children:[(0,t.jsx)("div",{className:"w-full bg-[var(--rawuh-error)] rounded-t-sm transition-all duration-300",style:{height:`${a}px`}}),(0,t.jsx)("div",{className:"w-full bg-[var(--rawuh-success)] transition-all duration-300",style:{height:`${s}px`}})]})},e.week)})}),(0,t.jsx)("div",{className:"absolute left-8 right-0 bottom-0 flex justify-around",children:e.map(e=>(0,t.jsx)("span",{className:"text-xs text-[var(--rawuh-text-muted)] flex-1 text-center",children:e.week},e.week))})]}),(0,t.jsxs)("div",{className:"mt-4 pt-4 border-t border-[var(--rawuh-border)] grid grid-cols-3 gap-4 text-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-2xl font-bold text-[var(--rawuh-success)]",children:[n.rate,"%"]}),(0,t.jsx)("p",{className:"text-xs text-[var(--rawuh-text-muted)]",children:"Avg. Attendance"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-[var(--rawuh-text)]",children:n.present}),(0,t.jsx)("p",{className:"text-xs text-[var(--rawuh-text-muted)]",children:"Total Present"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-[var(--rawuh-error)]",children:n.absent}),(0,t.jsx)("p",{className:"text-xs text-[var(--rawuh-text-muted)]",children:"Total Absent"})]})]})]})}function c(){let[e,a]=(0,s.useState)([]),[r,n]=(0,s.useState)(!0),[d,c]=(0,s.useState)(null);return((0,s.useEffect)(()=>{!async function(){try{let e=await i.apiClient.getActiveSessions();a(e.data||[])}catch(e){console.error("Failed to fetch active sessions:",e),c(e instanceof Error?e.message:"Failed to load sessions")}finally{n(!1)}}()},[]),r)?(0,t.jsx)("div",{className:"bg-white rounded-xl border border-[var(--rawuh-border)] p-5",children:(0,t.jsxs)("div",{className:"flex items-center justify-center gap-3 text-[var(--rawuh-text-muted)] py-8",children:[(0,t.jsx)("span",{className:"material-symbols-outlined animate-spin",children:"progress_activity"}),(0,t.jsx)("span",{children:"Loading sessions..."})]})}):(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-[var(--rawuh-border)] p-5",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-[var(--rawuh-text)]",children:"Active Sessions"}),(0,t.jsx)("p",{className:"text-sm text-[var(--rawuh-text-muted)]",children:"Currently running attendance sessions"})]}),(0,t.jsx)("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-[var(--rawuh-primary)] text-white text-xs font-bold rounded-full",children:e.length})]}),(0,t.jsx)("div",{className:"space-y-3",children:0===e.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("span",{className:"material-symbols-outlined text-4xl text-[var(--rawuh-text-muted)] mb-2",style:{fontVariationSettings:"'FILL' 0, 'wght' 400"},children:"event_busy"}),(0,t.jsx)("p",{className:"text-sm text-[var(--rawuh-text-muted)]",children:"No active sessions"})]}):e.map(e=>(0,t.jsxs)("div",{className:"p-4 rounded-lg border border-[var(--rawuh-border)] hover:border-[var(--rawuh-primary)] transition-colors cursor-pointer",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-[var(--rawuh-text)]",children:e.class_name||"Class Session"}),(0,t.jsxs)("p",{className:"text-sm text-[var(--rawuh-text-muted)]",children:[e.class_code," - Section ",e.class_section]})]}),(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-[var(--rawuh-success-muted)] text-[var(--rawuh-success)] text-xs font-medium",children:[(0,t.jsx)("span",{className:"w-1.5 h-1.5 bg-[var(--rawuh-success)] rounded-full animate-pulse"}),"Live"]})]}),e.total_students&&(0,t.jsxs)("div",{className:"mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm mb-1",children:[(0,t.jsx)("span",{className:"text-[var(--rawuh-text-muted)]",children:"Attendance"}),(0,t.jsxs)("span",{className:"font-medium text-[var(--rawuh-text)]",children:[e.present_count||0,"/",e.total_students]})]}),(0,t.jsx)("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-[var(--rawuh-primary)] rounded-full transition-all duration-300",style:{width:`${(e.present_count||0)/e.total_students*100}%`}})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsxs)("span",{className:"text-[var(--rawuh-text-muted)]",children:["Week ",e.week]}),(0,t.jsx)(l.default,{href:`/classes/${e.class_id}`,className:"font-medium text-[var(--rawuh-primary)] hover:underline",children:"View Details"})]})]},e.session_id))}),(0,t.jsx)(l.default,{href:"/sessions",className:"block w-full mt-4 py-2.5 text-sm font-medium text-[var(--rawuh-primary)] bg-[var(--rawuh-primary-muted)] rounded-lg hover:bg-blue-100 transition-colors text-center",children:"View All Sessions"})]})}var x=e.i(4292);function o(){let{user:e}=(0,x.useAuth)(),[l,o]=(0,s.useState)(null),[u,h]=(0,s.useState)(null),[m,p]=(0,s.useState)(null),[v,j]=(0,s.useState)(!0),[f,w]=(0,s.useState)(null);(0,s.useEffect)(()=>{!async function(){try{j(!0);let[e,t,s,a]=await Promise.all([i.apiClient.getMyStats().catch(()=>({data:null})),i.apiClient.getProfile(),i.apiClient.getMyClasses(),i.apiClient.getActiveSessions().catch(()=>({data:[]}))]);console.log("Stats response:",e),console.log("Classes response:",s),console.log("Active sessions response:",a);let r=s.data||[],l=a.data||[],n=e.data,d={total_classes:n?.total_classes||r.length,active_sessions:n?.active_sessions||l.length,total_students:n?.total_students||0};if(o(d),h(t.data),r.length>0){let e=r.map(e=>i.apiClient.getSessionHistory(e.id).catch(()=>({data:[]}))),t=await Promise.all(e),s=0,a=0,l=0;t.forEach(e=>{(e.data||[]).forEach(e=>{e.total_students&&e.total_students>0&&(s+=e.present_count||0,a+=e.total_students,e.total_students>l&&(l=e.total_students))})}),a>0&&p(Math.round(s/a*1e3)/10),0===d.total_students&&l>0&&o(e=>e?{...e,total_students:l}:e)}}catch(e){console.error("Failed to fetch dashboard data:",e),w(e instanceof Error?e.message:"Failed to load data")}finally{j(!1)}}()},[]);let b=u?.lecturer_info?.name||u?.student_info?.name||e?.email||"User",g=`Welcome back, ${b.split(" ")[0]}`;return v?(0,t.jsx)(a.default,{title:"Dashboard",subtitle:"Loading...",children:(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 text-[var(--rawuh-text-muted)]",children:[(0,t.jsx)("span",{className:"material-symbols-outlined animate-spin",children:"progress_activity"}),(0,t.jsx)("span",{children:"Loading dashboard..."})]})})}):f?(0,t.jsx)(a.default,{title:"Dashboard",subtitle:"Error",children:(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("span",{className:"material-symbols-outlined text-4xl text-[var(--rawuh-error)] mb-2",children:"error"}),(0,t.jsx)("p",{className:"text-[var(--rawuh-error)]",children:f}),(0,t.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-[var(--rawuh-primary)] text-white rounded-lg text-sm",children:"Retry"})]})})}):(0,t.jsxs)(a.default,{title:"Dashboard",subtitle:g,children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5 mb-6",children:[(0,t.jsx)(r,{icon:(0,t.jsx)("span",{className:"material-symbols-outlined text-2xl text-[var(--rawuh-primary)]",style:{fontVariationSettings:"'FILL' 0, 'wght' 400"},children:"school"}),iconBgColor:"var(--rawuh-primary-muted)",title:"Total Classes",value:l?.total_classes??"-",subtitle:"This semester"}),(0,t.jsx)(r,{icon:(0,t.jsx)("span",{className:"material-symbols-outlined text-2xl text-[var(--rawuh-success)]",style:{fontVariationSettings:"'FILL' 0, 'wght' 400"},children:"play_circle"}),iconBgColor:"var(--rawuh-success-muted)",title:"Active Sessions",value:l?.active_sessions??"-",subtitle:"Currently running"}),(0,t.jsx)(r,{icon:(0,t.jsx)("span",{className:"material-symbols-outlined text-2xl text-[var(--rawuh-secondary-brand)]",style:{fontVariationSettings:"'FILL' 0, 'wght' 400"},children:"groups"}),iconBgColor:"#FFF3E8",title:"Total Students",value:l?.total_students??"-",subtitle:"Across all classes"}),(0,t.jsx)(r,{icon:(0,t.jsx)("span",{className:"material-symbols-outlined text-2xl text-[var(--rawuh-main)]",style:{fontVariationSettings:"'FILL' 0, 'wght' 400"},children:"percent"}),iconBgColor:"#EEEEF5",title:"Avg. Attendance",value:null!==m?`${m}%`:"-",subtitle:"All sessions"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[(0,t.jsx)("div",{className:"xl:col-span-2",children:(0,t.jsx)(n,{})}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(c,{}),(0,t.jsx)(d,{})]})]})]})}e.s(["default",()=>o],7856)},5075,(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",()=>e.r(7856)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push(["/"])})},8761,e=>{e.v(t=>Promise.all(["static/chunks/df56c2ef92c6043e.js"].map(t=>e.l(t))).then(()=>t(3594)))},8805,e=>{e.v(t=>Promise.all(["static/chunks/5ec9ab7aae3f3e76.js"].map(t=>e.l(t))).then(()=>t(9466)))}]);